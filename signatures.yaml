# Add new signatures to identify appropriate protocols
# Note that signatures are generally checked from top-down order so encrypted 
# protocols are listed before 
signatures:
    - protocol: smb
      regex: "(microsoft-ds|netbios|smb|samba|smbd)"
    - protocol: https
      regex: "https|ssl/http|ssl/ssl"
    - protocol: http
      regex: "http(\\s|$|-)"
    - protocol: imaps
      regex: "ssl/imap|imap-ssl|imaps"
    - protocol: imap
      regex: "imap(\\s|$)"
    - protocol: pop3s
      regex: "pop3s|pop3-ssl|ssl/pop3"
    - protocol: pop3
      regex: "pop3(\\s|$)"
    - protocol: ftps
      regex: "ssl/ftp|ftp-ssl|ftps"
    - protocol: ftp
      regex: "[^t]ftp(\\s|$)"
    - protocol: "ldaps"
      regex: "(^636/tcp|ldap\\s|ldap$)"
    - protocol: "ldap"
      regex: "(^389/tcp|ldap)"
    - protocol: tftp
      regex: "tftp"
    - protocol: rsh_rlogin
      regex: "^514/tcp"
    - protocol: smtps
      regex: "ssl/smtp|smtp-ssl|smtps"
    - protocol: smtp
      regex: "smtp"
    - protocol: rpcbind
      regex: "portmap|msrpc"
    - protocol: dns
      regex: "(dns|[\\s]domain[\\s|$])"
    - protocol: "rdp"
      regex: "ms-wbt"
    - protocol: "mssql"
      regex: "ms-sql|mssql"
    - protocol: "mysql"
      regex: "my-sql|mysql"
    - protocol: "rdp_gateway"
      regex: "(3391/tcp|3391/udp|rdp-gateway|rdpgateway)"
    - protocol: "ssh"
      regex: "ssh"
    - protocol: "printer"
      regex: "^9100/tcp"
    - protocol: "minishare"
      regex: "^123/tcp"
    - protocol: "jolokia"
      regex: "^8778/tcp"
    - protocol: "hadoop"
      regex: "^(8088|8090)/tcp"
    - protocol: "tomcat"
      regex: "^8009/tcp"
    - protocol: "oracle_t3"
      regex: "^700[0-9]|7010/tcp"
    - protocol: "oracle_tns"
      regex: "^1521/tcp"
    - protocol: "sophos"
      regex: "^819[2-3]/tcp"
    - protocol: "kubernetes"
      regex: "(^10250/tcp|kubernetes)"
    - protocol: "apache_solr"
      regex: "(^(8983|18983)/tcp)"
    - protocol: "docker"
      regex: "^237[5-6]/tcp"
    - protocol: "mongodb"
      regex: "^2701[7-9]/tcp"
    - protocol: "elasticsearch"
      regex: "^9200/tcp"
    - protocol: "http_proxy"
      regex: "(^3128/tcp|http-proxy|squid)"
    - protocol: "kerberos"
      regex: "(^88/tcp|kerberos)"
    - protocol: "telnet"
      regex: "telnet"
    - protocol: "java-rmi"
      regex: "(^(1099|1100|2001)/tcp|java-rmi)"
    - protocol: "cups"
      regex: "(^631/tcp|cups)"
    - protocol: "nfs"
      regex: "(^2049/tcp|nfs)"
    - protocol: "vnc"
      regex: "(^590[0-9]/tcp|vnc)"
    - protocol: "iscsi"
      regex: "(^3260/tcp|iscsi)"
    - protocol: "ike"
      regex: "(^4500/tcp|isakmp|ike)"
    - protocol: "snmp"
      regex: "(^161/udp|snmp)"
    - protocol: "ntp"
      regex: "(^123/udp|ntp)"
    - protocol: "bmc_ipmi"
      regex: "^623/tcp"
    - protocol: "cisco_smart_install"
      regex: "^4786/tcp"
    - protocol: "cisco_rest_api"
      regex: "^55443/tcp"
    - protocol: "nodejs"
      regex: "^(3000/tcp|node .js|node js|nodejs)"
    - protocol: "splunk"
      regex: "^(8000/tcp|splunk)"
    - protocol: "chromecast"
      regex: "^(8008/tcp|chromecast)"
